<%= javascript_include_tag "games" %>
<%= stylesheet_link_tag    "games" %>

<%= content_tag :div, id: "game-data", data: {coral: @game.coral, ships: get_ship_json(@game)} do %>
<% end %>

<canvas id="myCanvas" width="600" height="600"></canvas>
<script>

  var canvas = document.getElementById('myCanvas');
  var ctx = canvas.getContext('2d');
  var N = 30;
  var HEIGHT = canvas.height
  var WIDTH = canvas.width
  var SQ_WIDTH = Math.floor(WIDTH/N)

  // Inputs
  window.addEventListener('keydown', this.check, false);

  // game logistics
  game = new Game(ctx);

  function check(e) {
    var code = e.keyCode;
    switch (code) {
      case 13: game.FinalizeMove(); break; //Space Bar
      case 65:  game.Traverse(1); break; //Left key
      case 87:  game.Traverse(0); break; //Up key
      case 68:  game.Traverse(3); break; //Right key
      case 83:  game.Traverse(2); break; //Down key
      case 39:  game.NextShipDown(); break; // 'a' key
      case 37:  game.NextShipUp(); break; // 's' key
      default:  //Everything else
    }
  }

  setInterval(function () {
    ctx.clearRect(0, 0, WIDTH, HEIGHT);
    game.Display();
  }, 36);
</script>
