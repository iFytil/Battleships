<%= javascript_include_tag "games" %>
<%= stylesheet_link_tag    "games" %>

<%= content_tag :div, id: "game-data", data: {game: @game.to_json(:include => :moves), userid: current_user.id, ships: @game.ships.to_json(:include => :shiptype)} do %>
<% end %>

<canvas id="myCanvas" width="700" height="630"></canvas>



<script>

  var dispatcher = new WebSocketRails(window.location.host + "/websocket", true)

  var canvas = document.getElementById('myCanvas');
  var ctx = canvas.getContext('2d');
  var N = 30;
  var HEIGHT = canvas.height-30
  var WIDTH = canvas.height-30 //make it square
  var BAR_WIDTH = canvas.width-HEIGHT
  var TEXT_BAR_WIDTH = canvas.height-600
  var SQ_WIDTH = Math.floor(WIDTH/N)
  var GAME_DATA = $('#game-data').data("game")
  var USERID = $('#game-data').data("userid")
  var pid = ((USERID == GAME_DATA.player_1_id) ? Turn.First : Turn.Second)
  var SHIPS = $('#game-data').data("ships")

  // game logistics
  var game = new Game();
  
  setInterval(function () {
    game.Display();
  }, 36);

</script>
